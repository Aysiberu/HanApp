<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Reset password</title></head>
<body style="font-family:Arial,Helvetica,sans-serif">
  <main style="max-width:720px;margin:40px auto;padding:20px;border:1px solid #ddd;border-radius:8px;background:#fff">
    <h1>Reset password</h1>
    <p>Enter your email, the reset code you received, and a new password to reset your password.</p>
    <form id="resetForm">
      <label>Email <input id="resetEmail" type="email" required></label><br>
      <label>Reset code <input id="resetCode" required></label><br>
      <label>New password <input id="resetNew" type="password" required></label><br>
      <div style="margin-top:8px"><button type="submit">Set new password</button></div>
    </form>
    <div id="resetMsg" style="color:#a00;margin-top:8px;display:none"></div>
    <p style="margin-top:8px"><a href="loginpage.html">Return to login</a></p>
  </main>
  <script>
    document.getElementById('resetForm').addEventListener('submit', async function(e){
      e.preventDefault(); const m=document.getElementById('resetMsg'); m.style.display='none';
      const email=document.getElementById('resetEmail').value.trim(); const code=document.getElementById('resetCode').value.trim(); const newPassword=document.getElementById('resetNew').value;
      try{ const res = await fetch('/api/reset_password', { method:'POST', headers:{ 'Content-Type':'application/json'}, body: JSON.stringify({ email, code, newPassword }) }); const body = await res.json(); if(!res.ok) throw new Error(body.error || 'Failed'); alert('Password reset â€” please log in'); window.location.href='/loginpage.html'; }catch(err){ m.style.display='block'; m.textContent = err.message || 'Error'; }
    });
  </script>
  </main>
</body>
</html>